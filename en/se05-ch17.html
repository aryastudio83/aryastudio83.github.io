<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Inner Classes</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.885421c5.js" as="script"><link rel="preload" href="/assets/js/2.63033d72.js" as="script"><link rel="preload" href="/assets/js/99.9c0aaa7c.js" as="script"><link rel="prefetch" href="/assets/js/10.0b3c205e.js"><link rel="prefetch" href="/assets/js/100.96b937c1.js"><link rel="prefetch" href="/assets/js/101.307416f3.js"><link rel="prefetch" href="/assets/js/102.ad03aa52.js"><link rel="prefetch" href="/assets/js/103.f62a5b6a.js"><link rel="prefetch" href="/assets/js/104.af54bf4a.js"><link rel="prefetch" href="/assets/js/105.7e28a867.js"><link rel="prefetch" href="/assets/js/106.f43671e2.js"><link rel="prefetch" href="/assets/js/107.193e626f.js"><link rel="prefetch" href="/assets/js/108.48f6a137.js"><link rel="prefetch" href="/assets/js/109.cd1a3844.js"><link rel="prefetch" href="/assets/js/11.44430f62.js"><link rel="prefetch" href="/assets/js/110.1dd502da.js"><link rel="prefetch" href="/assets/js/111.ccb021d8.js"><link rel="prefetch" href="/assets/js/112.75e535d0.js"><link rel="prefetch" href="/assets/js/113.bfe1eaad.js"><link rel="prefetch" href="/assets/js/114.521ecc45.js"><link rel="prefetch" href="/assets/js/115.848462f3.js"><link rel="prefetch" href="/assets/js/116.f7937681.js"><link rel="prefetch" href="/assets/js/117.d00e5088.js"><link rel="prefetch" href="/assets/js/118.fd0e9def.js"><link rel="prefetch" href="/assets/js/119.c64902aa.js"><link rel="prefetch" href="/assets/js/12.d9d3b76c.js"><link rel="prefetch" href="/assets/js/120.c029eaac.js"><link rel="prefetch" href="/assets/js/121.17f7bf8c.js"><link rel="prefetch" href="/assets/js/122.a46a015c.js"><link rel="prefetch" href="/assets/js/123.bd8273f5.js"><link rel="prefetch" href="/assets/js/124.f0266688.js"><link rel="prefetch" href="/assets/js/125.23db0445.js"><link rel="prefetch" href="/assets/js/126.6c8e4b81.js"><link rel="prefetch" href="/assets/js/127.58121e7c.js"><link rel="prefetch" href="/assets/js/128.e81625d0.js"><link rel="prefetch" href="/assets/js/129.2086e255.js"><link rel="prefetch" href="/assets/js/13.02f01f86.js"><link rel="prefetch" href="/assets/js/130.358aa726.js"><link rel="prefetch" href="/assets/js/131.2db58096.js"><link rel="prefetch" href="/assets/js/132.bcbdada5.js"><link rel="prefetch" href="/assets/js/133.2c908f82.js"><link rel="prefetch" href="/assets/js/134.eade1bde.js"><link rel="prefetch" href="/assets/js/135.b89936b5.js"><link rel="prefetch" href="/assets/js/136.e88a267d.js"><link rel="prefetch" href="/assets/js/137.61035549.js"><link rel="prefetch" href="/assets/js/138.f89fbe70.js"><link rel="prefetch" href="/assets/js/139.771cd71c.js"><link rel="prefetch" href="/assets/js/14.7f3bb0b0.js"><link rel="prefetch" href="/assets/js/140.34a95e86.js"><link rel="prefetch" href="/assets/js/141.ec95bcce.js"><link rel="prefetch" href="/assets/js/142.13e1ee8e.js"><link rel="prefetch" href="/assets/js/143.1aa42e4b.js"><link rel="prefetch" href="/assets/js/144.37aab2b7.js"><link rel="prefetch" href="/assets/js/145.be3bc861.js"><link rel="prefetch" href="/assets/js/146.e5d674e1.js"><link rel="prefetch" href="/assets/js/147.58aec8b2.js"><link rel="prefetch" href="/assets/js/148.2b890544.js"><link rel="prefetch" href="/assets/js/149.abf23b17.js"><link rel="prefetch" href="/assets/js/15.9ee435da.js"><link rel="prefetch" href="/assets/js/150.294e67e5.js"><link rel="prefetch" href="/assets/js/151.0a384fa7.js"><link rel="prefetch" href="/assets/js/152.fdcc22f9.js"><link rel="prefetch" href="/assets/js/153.9da97a5a.js"><link rel="prefetch" href="/assets/js/154.9d75aa68.js"><link rel="prefetch" href="/assets/js/155.cb639e66.js"><link rel="prefetch" href="/assets/js/156.bac15746.js"><link rel="prefetch" href="/assets/js/157.59912327.js"><link rel="prefetch" href="/assets/js/158.70b73dcc.js"><link rel="prefetch" href="/assets/js/159.e88d2e22.js"><link rel="prefetch" href="/assets/js/16.35e658e9.js"><link rel="prefetch" href="/assets/js/160.f139525d.js"><link rel="prefetch" href="/assets/js/161.a37a29b7.js"><link rel="prefetch" href="/assets/js/162.6f5d3003.js"><link rel="prefetch" href="/assets/js/163.14aa422f.js"><link rel="prefetch" href="/assets/js/164.4b33e948.js"><link rel="prefetch" href="/assets/js/165.fb54ffee.js"><link rel="prefetch" href="/assets/js/166.041ac020.js"><link rel="prefetch" href="/assets/js/167.afa2fc40.js"><link rel="prefetch" href="/assets/js/168.e8dd5ce6.js"><link rel="prefetch" href="/assets/js/169.c6f23778.js"><link rel="prefetch" href="/assets/js/17.75911907.js"><link rel="prefetch" href="/assets/js/170.845b5d59.js"><link rel="prefetch" href="/assets/js/171.7e3dcda3.js"><link rel="prefetch" href="/assets/js/172.2d115602.js"><link rel="prefetch" href="/assets/js/173.872cef97.js"><link rel="prefetch" href="/assets/js/174.2ba2ca5e.js"><link rel="prefetch" href="/assets/js/175.dc1b572f.js"><link rel="prefetch" href="/assets/js/176.7692d4c3.js"><link rel="prefetch" href="/assets/js/177.22d1ef39.js"><link rel="prefetch" href="/assets/js/178.392431b3.js"><link rel="prefetch" href="/assets/js/179.31375329.js"><link rel="prefetch" href="/assets/js/18.e1886c50.js"><link rel="prefetch" href="/assets/js/180.eab449ae.js"><link rel="prefetch" href="/assets/js/181.de02433a.js"><link rel="prefetch" href="/assets/js/182.69f2a2ac.js"><link rel="prefetch" href="/assets/js/183.a7c29149.js"><link rel="prefetch" href="/assets/js/184.d172410d.js"><link rel="prefetch" href="/assets/js/185.55f5cb3b.js"><link rel="prefetch" href="/assets/js/186.fe28ccd6.js"><link rel="prefetch" href="/assets/js/187.7078cb3a.js"><link rel="prefetch" href="/assets/js/188.33d16ad2.js"><link rel="prefetch" href="/assets/js/189.429e8408.js"><link rel="prefetch" href="/assets/js/19.0c100fc8.js"><link rel="prefetch" href="/assets/js/190.9fc52549.js"><link rel="prefetch" href="/assets/js/191.579656e4.js"><link rel="prefetch" href="/assets/js/192.1faeacc0.js"><link rel="prefetch" href="/assets/js/193.26b1f939.js"><link rel="prefetch" href="/assets/js/194.7b06da95.js"><link rel="prefetch" href="/assets/js/195.99cc7e20.js"><link rel="prefetch" href="/assets/js/196.1ea3220f.js"><link rel="prefetch" href="/assets/js/197.3738ecaa.js"><link rel="prefetch" href="/assets/js/198.b5f0dcb0.js"><link rel="prefetch" href="/assets/js/199.4c37b475.js"><link rel="prefetch" href="/assets/js/20.d3ec4ffd.js"><link rel="prefetch" href="/assets/js/200.d0f3b502.js"><link rel="prefetch" href="/assets/js/201.56c48b30.js"><link rel="prefetch" href="/assets/js/202.dc7fe2ea.js"><link rel="prefetch" href="/assets/js/203.2e7e7f17.js"><link rel="prefetch" href="/assets/js/204.71fe20bf.js"><link rel="prefetch" href="/assets/js/205.41b84b9d.js"><link rel="prefetch" href="/assets/js/206.cdc16e15.js"><link rel="prefetch" href="/assets/js/21.718b7fbf.js"><link rel="prefetch" href="/assets/js/22.3ae17164.js"><link rel="prefetch" href="/assets/js/23.ad0a6015.js"><link rel="prefetch" href="/assets/js/24.4487bebb.js"><link rel="prefetch" href="/assets/js/25.41a5d823.js"><link rel="prefetch" href="/assets/js/26.4e51890f.js"><link rel="prefetch" href="/assets/js/27.fd478fd6.js"><link rel="prefetch" href="/assets/js/28.211d4aa6.js"><link rel="prefetch" href="/assets/js/29.5b060608.js"><link rel="prefetch" href="/assets/js/3.75220a5c.js"><link rel="prefetch" href="/assets/js/30.e24a6501.js"><link rel="prefetch" href="/assets/js/31.79b31301.js"><link rel="prefetch" href="/assets/js/32.743ba4bf.js"><link rel="prefetch" href="/assets/js/33.4fff5d91.js"><link rel="prefetch" href="/assets/js/34.ac036805.js"><link rel="prefetch" href="/assets/js/35.8021acce.js"><link rel="prefetch" href="/assets/js/36.469285e3.js"><link rel="prefetch" href="/assets/js/37.ea7464b1.js"><link rel="prefetch" href="/assets/js/38.be0f1986.js"><link rel="prefetch" href="/assets/js/39.42be918e.js"><link rel="prefetch" href="/assets/js/4.f5011ba2.js"><link rel="prefetch" href="/assets/js/40.ac571077.js"><link rel="prefetch" href="/assets/js/41.f593e342.js"><link rel="prefetch" href="/assets/js/42.bca3b705.js"><link rel="prefetch" href="/assets/js/43.f5070b9f.js"><link rel="prefetch" href="/assets/js/44.a3911525.js"><link rel="prefetch" href="/assets/js/45.b9fc883d.js"><link rel="prefetch" href="/assets/js/46.464c7e51.js"><link rel="prefetch" href="/assets/js/47.7807b8a1.js"><link rel="prefetch" href="/assets/js/48.d5ae16c3.js"><link rel="prefetch" href="/assets/js/49.6d24b07e.js"><link rel="prefetch" href="/assets/js/5.b582c580.js"><link rel="prefetch" href="/assets/js/50.4d1db70c.js"><link rel="prefetch" href="/assets/js/51.89065036.js"><link rel="prefetch" href="/assets/js/52.f308826a.js"><link rel="prefetch" href="/assets/js/53.f416c945.js"><link rel="prefetch" href="/assets/js/54.de986d56.js"><link rel="prefetch" href="/assets/js/55.a38a082e.js"><link rel="prefetch" href="/assets/js/56.1c42fbac.js"><link rel="prefetch" href="/assets/js/57.077a2b61.js"><link rel="prefetch" href="/assets/js/58.80d7cb5e.js"><link rel="prefetch" href="/assets/js/59.c2ee2cf4.js"><link rel="prefetch" href="/assets/js/6.52fc7c97.js"><link rel="prefetch" href="/assets/js/60.0bf8a1a7.js"><link rel="prefetch" href="/assets/js/61.1257ff7b.js"><link rel="prefetch" href="/assets/js/62.c41e8c91.js"><link rel="prefetch" href="/assets/js/63.39361554.js"><link rel="prefetch" href="/assets/js/64.597581ff.js"><link rel="prefetch" href="/assets/js/65.9e1a8d7c.js"><link rel="prefetch" href="/assets/js/66.334ddb5e.js"><link rel="prefetch" href="/assets/js/67.abb8980a.js"><link rel="prefetch" href="/assets/js/68.50d6ccbd.js"><link rel="prefetch" href="/assets/js/69.78adbe1e.js"><link rel="prefetch" href="/assets/js/7.069c08dd.js"><link rel="prefetch" href="/assets/js/70.b31703cd.js"><link rel="prefetch" href="/assets/js/71.ccd34bfc.js"><link rel="prefetch" href="/assets/js/72.a2477889.js"><link rel="prefetch" href="/assets/js/73.3c0a5fa3.js"><link rel="prefetch" href="/assets/js/74.e27d5da5.js"><link rel="prefetch" href="/assets/js/75.581bc1ad.js"><link rel="prefetch" href="/assets/js/76.1eb8f4e3.js"><link rel="prefetch" href="/assets/js/77.fdab5a7d.js"><link rel="prefetch" href="/assets/js/78.176ad3f1.js"><link rel="prefetch" href="/assets/js/79.a4feb4cd.js"><link rel="prefetch" href="/assets/js/8.5f8a95e5.js"><link rel="prefetch" href="/assets/js/80.74a9ea67.js"><link rel="prefetch" href="/assets/js/81.b475a94b.js"><link rel="prefetch" href="/assets/js/82.aa6cf5bc.js"><link rel="prefetch" href="/assets/js/83.3ef99db9.js"><link rel="prefetch" href="/assets/js/84.d93f9635.js"><link rel="prefetch" href="/assets/js/85.0e647886.js"><link rel="prefetch" href="/assets/js/86.dc078fed.js"><link rel="prefetch" href="/assets/js/87.975d4001.js"><link rel="prefetch" href="/assets/js/88.19f5ee6a.js"><link rel="prefetch" href="/assets/js/89.d6d84503.js"><link rel="prefetch" href="/assets/js/9.fc7a2252.js"><link rel="prefetch" href="/assets/js/90.6c1b5340.js"><link rel="prefetch" href="/assets/js/91.1f9f9747.js"><link rel="prefetch" href="/assets/js/92.d8d60a44.js"><link rel="prefetch" href="/assets/js/93.28110f57.js"><link rel="prefetch" href="/assets/js/94.f4c5cd90.js"><link rel="prefetch" href="/assets/js/95.afa19f49.js"><link rel="prefetch" href="/assets/js/96.abed696f.js"><link rel="prefetch" href="/assets/js/97.b4b650c9.js"><link rel="prefetch" href="/assets/js/98.7892a857.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="inner-classes"><a href="#inner-classes" class="header-anchor">#</a> Inner Classes</h1> <blockquote><p>Inner classes are like nested classes, but an object of an inner class maintains a reference to the outer class.</p></blockquote> <p>An <code>inner</code> class has an implicit link to the outer class. In the following example, <code>Hotel</code> is like <code>Airport</code> from [Nested Classes](javascript:void(0)), but it uses <code>inner</code> classes. Note that <code>reception</code> is part of <code>Hotel</code>, but <code>callReception()</code>, which is a member of the nested class <code>Room</code>, accesses <code>reception</code> without qualification:</p> <div class="language- extra-class"><pre class="language-text"><code>// InnerClasses/Hotel.kt
package innerclasses
import atomictest.eq

class Hotel(private val reception: String) {
  open inner class Room(val id: Int = 0) {
    // Uses 'reception' from outer class:
    fun callReception() =
      &quot;Room $id Calling $reception&quot;
  }
  private inner class Closet : Room()
  fun closet(): Room = Closet()
}

fun main() {
  val nycHotel = Hotel(&quot;311&quot;)
  // You need an outer object to
  // create an instance of the inner class:
  val room = nycHotel.Room(319)
  room.callReception() eq
    &quot;Room 319 Calling 311&quot;
  val sfHotel = Hotel(&quot;0&quot;)
  val closet = sfHotel.closet()
  closet.callReception() eq &quot;Room 0 Calling 0&quot;
}
</code></pre></div><p>Because <code>Closet</code> inherits the inner class <code>Room</code>, <code>Closet</code> must also be an <code>inner</code> class. Nested classes cannot inherit from <code>inner</code> classes.</p> <p><code>Closet</code> is <code>private</code>, so it is only visible within the scope of <code>Hotel</code>.</p> <p>An <code>inner</code> object keeps a reference to its associated outer object. Thus, when creating an <code>inner</code> object you must first have an outer object. You cannot create a <code>Room</code> object without a <code>Hotel</code> object, as you see with <code>nycHotel.Room()</code>.</p> <p><code>inner</code> <code>data</code> classes are not allowed.</p> <h3 id="qualified-this"><a href="#qualified-this" class="header-anchor">#</a> Qualified <code>this</code></h3> <p>One of the benefits of classes is the <code>this</code> reference. You don’t have to explicitly say “the current object” when you access a property or member function.</p> <p>With a simple class, the meaning of <code>this</code> is obvious, but with an <code>inner</code> class, <code>this</code> could refer to either the <code>inner</code> object or an outer object. To resolve this issue, Kotlin provides the <em>qualified <code>this</code></em> syntax: <code>this</code> followed by <code>@</code> and the name of the target class.</p> <p>Consider three levels of classes: an outer class <code>Fruit</code> containing an <code>inner</code> class <code>Seed</code>, which itself contains an <code>inner</code> class <code>DNA</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>// InnerClasses/QualifiedThis.kt
package innerclasses
import atomictest.eq
import typechecking.name

class Fruit { // Implicit label @Fruit
  fun changeColor(color: String) =
    &quot;Fruit $color&quot;
  fun absorbWater(amount: Int) {}
  inner class Seed { // Implicit label @Seed
    fun changeColor(color: String) =
      &quot;Seed $color&quot;
    fun germinate() {}
    fun whichThis() {
      // Defaults to the current class:
      this.name eq &quot;Seed&quot;
      // To clarify, you can redundantly
      // qualify the default this:
      this@Seed.name  eq &quot;Seed&quot;
      // Must explicitly access Fruit:
      this@Fruit.name  eq &quot;Fruit&quot;
      // Cannot access a further-inner class:
      // this@DNA.name
    }
    inner class DNA { // Implicit label @DNA
      fun changeColor(color: String) {
        // changeColor(color) // Recursive
        this@Seed.changeColor(color)
        this@Fruit.changeColor(color)
      }
      fun plant() {
        // Call outer-class functions
        // Without qualification:
        germinate()
        absorbWater(10)
      }
      // Extension function:
      fun Int.grow() { // Implicit label @grow
        // Default is the Int.grow() receiver:
        this.name eq &quot;Int&quot;
        // Redundant qualification:
        this@grow.name  eq &quot;Int&quot;
        // You can still access everything:
        this@DNA.name  eq &quot;DNA&quot;
        this@Seed.name  eq &quot;Seed&quot;
        this@Fruit.name  eq &quot;Fruit&quot;
      }
      // Extension functions on outer classes:
      fun Seed.plant() {}
      fun Fruit.plant() {}
      fun whichThis() {
        // Defaults to the current class:
        this.name eq &quot;DNA&quot;
        // Redundant qualification:
        this@DNA.name  eq &quot;DNA&quot;
        // The others must be explicit:
        this@Seed.name  eq &quot;Seed&quot;
        this@Fruit.name  eq &quot;Fruit&quot;
      }
    }
  }
}

// Extension function:
fun Fruit.grow(amount: Int) {
  absorbWater(amount)
  // Calls Fruit's version of changeColor():
  changeColor(&quot;Red&quot;) eq &quot;Fruit Red&quot;
}

// Inner-class extension function:
fun Fruit.Seed.grow(n: Int) {
  germinate()
  // Calls Seed's version of changeColor():
  changeColor(&quot;Green&quot;) eq &quot;Seed Green&quot;
}

// Inner-class extension function:
fun Fruit.Seed.DNA.grow(n: Int) = n.grow()

fun main() {
  val fruit = Fruit()
  fruit.grow(4)
  val seed = fruit.Seed()
  seed.grow(9)
  seed.whichThis()
  val dna = seed.DNA()
  dna.plant()
  dna.grow(5)
  dna.whichThis()
  dna.changeColor(&quot;Purple&quot;)
}
</code></pre></div><p><code>Fruit</code>, <code>Seed</code> and <code>DNA</code> all have functions called <code>changeColor()</code>, but there’s no overriding—this is not an inheritance relationship. Because they have the same name and signature, the only way to distinguish them is with a qualified <code>this</code>, as you see in <code>DNA</code>’s <code>changeColor()</code>. Inside <code>plant()</code>, functions in either of the two outer classes can be called without qualification if there are no name collisions.</p> <p>Even though it’s an extension function, <code>grow()</code> can still access all the objects in the outer class. <code>grow()</code> can be called anywhere the <code>Fruit.Seed.DNA</code> implicit receiver is available; for example, inside an extension function for <code>DNA</code>.</p> <h3 id="inner-class-inheritance"><a href="#inner-class-inheritance" class="header-anchor">#</a> Inner Class Inheritance</h3> <p>An inner class can inherit another inner class from a <em>different</em> outer class. Here, <code>Yolk</code> in <code>BigEgg</code> is derived from <code>Yolk</code> in <code>Egg</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>// InnerClasses/InnerClassInheritance.kt
package innerclasses
import atomictest.*

open class Egg {
  private var yolk = Yolk()
  open inner class Yolk {
    init { trace(&quot;Egg.Yolk()&quot;) }
    open fun f() { trace(&quot;Egg.Yolk.f()&quot;) }
  }
  init { trace(&quot;New Egg()&quot;) }
  fun insertYolk(y: Yolk) { yolk = y }
  fun g() { yolk.f() }
}

class BigEgg : Egg() {
  inner class Yolk : Egg.Yolk() {
    init { trace(&quot;BigEgg.Yolk()&quot;) }
    override fun f() {
      trace(&quot;BigEgg.Yolk.f()&quot;)
    }
  }
  init { insertYolk(Yolk()) }
}

fun main() {
  BigEgg().g()
  trace eq &quot;&quot;&quot;
    Egg.Yolk()
    New Egg()
    Egg.Yolk()
    BigEgg.Yolk()
    BigEgg.Yolk.f()
  &quot;&quot;&quot;
}
</code></pre></div><p><code>BigEgg.Yolk</code> explicitly names <code>Egg.Yolk</code> as its base class, and overrides its <code>f()</code> member function. The function <code>insertYolk()</code> allows <code>BigEgg</code> to upcast one of its own <code>Yolk</code> objects into the <code>yolk</code> reference in <code>Egg</code>, so when <code>g()</code> calls <code>yolk.f()</code>, the overridden version of <code>f()</code> is used. The second call to <code>Egg.Yolk()</code> is the base-class constructor call of the <code>BigEgg.Yolk</code> constructor. You can see that the overridden version of <code>f()</code> is used when <code>g()</code> is called.</p> <p>As a review of object construction, study the <code>trace</code> output until it makes sense.</p> <h3 id="local-anonymous-inner-classes"><a href="#local-anonymous-inner-classes" class="header-anchor">#</a> Local &amp; Anonymous Inner Classes</h3> <p>Classes defined inside member functions are called <em>local inner classes</em>. These can also be created anonymously, using an <em>object expression</em>, or using a [SAM conversion](javascript:void(0)). In all cases, the <code>inner</code> keyword is not used, but is implied:</p> <div class="language- extra-class"><pre class="language-text"><code>// InnerClasses/LocalInnerClasses.kt
package innerclasses
import atomictest.eq

fun interface Pet {
  fun speak(): String
}

object CreatePet {
  fun home() = &quot; home!&quot;
  fun dog(): Pet {
    val say = &quot;Bark&quot;
    // Local inner class:
    class Dog : Pet {
      override fun speak() = say + home()
    }
    return Dog()
  }
  fun cat(): Pet {
    val emit = &quot;Meow&quot;
    // Anonymous inner class:
    return object: Pet {
      override fun speak() = emit + home()
    }
  }
  fun hamster(): Pet {
    val squeak = &quot;Squeak&quot;
    // SAM conversion:
    return Pet { squeak + home() }
  }
}

fun main() {
  CreatePet.dog().speak() eq &quot;Bark home!&quot;
  CreatePet.cat().speak() eq &quot;Meow home!&quot;
  CreatePet.hamster().speak() eq &quot;Squeak home!&quot;
}
</code></pre></div><p>A local inner class has access to other elements in the function as well as elements in the outer-class object, thus <code>say</code>, <code>emit</code>, <code>squeak</code> and <code>home()</code> are available within <code>speak()</code>.</p> <p>You can identify an anonymous inner class because it uses an object expression, which you see in <code>cat()</code>. It returns an <code>object</code> of a class inherited from <code>Pet</code> that overrides <code>speak()</code>. Anonymous inner classes are smaller and more straightforward and do not create a named class that will only be used in one place. Even more compact is a [SAM conversion](javascript:void(0)), as seen in <code>hamster()</code>.</p> <p>Because inner classes keep a reference to the outer-class object, local inner classes can access all members of the enclosing class:</p> <div class="language- extra-class"><pre class="language-text"><code>// InnerClasses/CounterFactory.kt
package innerclasses
import atomictest.*

fun interface Counter {
  fun next(): Int
}

object CounterFactory {
  private var count = 0
  fun new(name: String): Counter {
    // Local inner class:
    class Local : Counter {
      init { trace(&quot;Local()&quot;) }
      override fun next(): Int {
        // Access local identifiers:
        trace(&quot;$name $count&quot;)
        return count++
      }
    }
    return Local()
  }
  fun new2(name: String): Counter {
    // Instance of an anonymous inner class:
    return object: Counter {
      init { trace(&quot;Counter()&quot;) }
      override fun next(): Int {
        trace(&quot;$name $count&quot;)
        return count++
      }
    }
  }
  fun new3(name: String): Counter {
    trace(&quot;Counter()&quot;)
    return Counter { // SAM conversion
      trace(&quot;$name $count&quot;)
      count++
    }
  }
}

fun main() {
  fun test(counter: Counter) {
    (0..3).forEach { counter.next() }
  }
  test(CounterFactory.new(&quot;Local&quot;))
  test(CounterFactory.new2(&quot;Anon&quot;))
  test(CounterFactory.new3(&quot;SAM&quot;))
  trace eq &quot;&quot;&quot;
    Local() Local 0 Local 1 Local 2 Local 3
    Counter() Anon 4 Anon 5 Anon 6 Anon 7
    Counter() SAM 8 SAM 9 SAM 10 SAM 11
  &quot;&quot;&quot;
}
</code></pre></div><p>A <code>Counter</code> keeps track of a <code>count</code> and returns the next <code>Int</code> value. <code>new()</code>, <code>new2()</code> and <code>new3()</code> each create a different implementation of the <code>Counter</code> interface. <code>new()</code> returns an instance of a named inner class, <code>new2()</code> returns an instance of an anonymous inner class, and <code>new3()</code> uses a [SAM conversion](javascript:void(0)) to create an anonymous object. All the resulting <code>Counter</code> objects have implicit access to the elements of the outer object, thus they are inner classes and not just nested classes. You can see from the output that <code>count</code> in <code>CounterFactory</code> is shared by all <code>Counter</code> objects.</p> <p>SAM conversions are limited—for example, they do not support <code>init</code> clauses.</p> <ul><li>-</li></ul> <p>In Kotlin, files can contain multiple top-level classes and functions. Because of this, there’s rarely a need for local classes, so if you do need them they should be basic and straightforward. For example, it’s reasonable to create a simple <code>data</code> class that’s only used inside a function. If a local class becomes complex, you should probably take it out of the function and make it a regular class.</p> <p><em><strong>Exercises and solutions can be found at www.AtomicKotlin.com.</strong></em></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.885421c5.js" defer></script><script src="/assets/js/2.63033d72.js" defer></script><script src="/assets/js/99.9c0aaa7c.js" defer></script>
  </body>
</html>
